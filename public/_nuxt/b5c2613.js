(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{347:function(t,e,o){"use strict";o.r(e);o(82);var n,c=o(27),l=o(90),r=(o(348),{name:"ChatBoard",data:function(){return{comments:[],comments_box:[],coment:""}},methods:{send:function(){l.a.firestore().collection("room").doc("001").collection("comments").add({content:this.coment,createdAt:new Date,userid:"001"}).then(this.coment="")},getChat:(n=Object(c.a)(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.a.firestore().collection("room").doc("001").collection("comments").orderBy("createdAt","asc").limit(50).get().then((function(t){t.forEach((function(t){e.comments_box.push({content:t.data().content,createdAt:t.data().createdAt.toDate().toLocaleTimeString().toLocaleString()})}))}));case 2:this.comments=this.comments_box,console.log(this.comments_box),this.comments_box=[];case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},watch:{},mounted:function(){var t=this;l.a.firestore().collection("room").doc("001").collection("comments").onSnapshot((function(){t.getChat()}))},created:function(){}}),d=o(39),m=o(55),h=o.n(m),v=o(205),f=o(325),y=o(349),C=o(156),_=o(157),w=o(102),x=o(73),k=o(337),I=o(343),component=Object(d.a)(r,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-list",{attrs:{"three-line":""}},[o("v-list",{directives:[{name:"chat-scroll",rawName:"v-chat-scroll",value:{always:!1,smooth:!0,scrollonremoved:!0},expression:"{always: false, smooth: true, scrollonremoved:true}"}],staticClass:"overflow-y-auto",attrs:{"max-height":"470",height:"470",elevation:"0",tile:""}},t._l(t.comments,(function(e,n){return o("v-list-item",{key:n,staticClass:"black--text",attrs:{index:n}},[o("v-list-item-subtitle",{staticClass:"text--primary"},[t._v(t._s(e.content))]),t._v(" "),o("v-list-item-subtitle",[t._v("\n                "+t._s(e.createdAt)+"\n            ")])],1)})),1),t._v(" "),o("v-card",{staticClass:"grey display-1  pa-0 ma-0",attrs:{height:"50",elevation:"0",tile:""}},[o("v-row",{staticClass:"ma-0 pa-0",attrs:{justify:"end"}},[o("v-col",{staticClass:"ma-0 pa-0 py-4",attrs:{cols:"6"}},[o("v-text-field",{staticClass:"ma-0",attrs:{dense:"",label:"Message",color:"black"},model:{value:t.coment,callback:function(e){t.coment=e},expression:"coment"}})],1),t._v(" "),o("v-col",{staticClass:"ma-0 pa-0 py-1",attrs:{cols:"2"}},[o("v-btn",{staticClass:"pa-0 ma-0 ml-1",attrs:{tile:"",large:"",color:"teal",icon:""},on:{click:t.send}},[o("v-icon",{staticClass:"pa-0 ma-0",attrs:{color:"white"}},[t._v("mdi-send")])],1)],1)],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports;h()(component,{VBtn:v.a,VCard:f.a,VCol:y.a,VIcon:C.a,VList:_.a,VListItem:w.a,VListItemSubtitle:x.b,VRow:k.a,VTextField:I.a})},357:function(t,e,o){"use strict";o.r(e);var n=o(90),c=o(348),l=o.n(c),r={name:"ChatBoard",data:function(){return{APIKey:"79dca892-7921-4630-b281-eee96ef188e9",selectedAudio:"",audios:[],videos:[],localStream:null,peerId:"",calltoid:"",deliveryId:"",flg:!1}},methods:{makeCall:function(){var t=this.peer.call(this.calltoid,this.localStream);this.connect(t)},connect:function(t){t.on("stream",(function(t){var e=document.getElementById("their-video");e.srcObject=t,e.play()}))}},watch:{deliveryId:function(){this.calltoid=this.deliveryId,""!=this.deliveryId&&this.makeCall()}},mounted:function(){var t=this;this.peer=new l.a({key:this.APIKey,debug:3}),this.peer.on("open",(function(){t.peerId=t.peer.id})),this.peer.on("call",(function(e){e.answer(t.localStream),t.connect(e)})),""!=this.items.user_id&&n.a.firestore().collection("delivery").doc("OJcNACQyCvNASCF2PJ6ktMDXFSu2").onSnapshot((function(){n.a.firestore().collection("delivery").doc("OJcNACQyCvNASCF2PJ6ktMDXFSu2").get().then((function(e){t.deliveryId=e.data().peer,t.flg=e.data().flg}))}))},computed:{items:function(){return this.$store.getters.delivery_info}},components:{Chat:o(347).default},created:function(){}},d=o(39),m=o(55),h=o.n(m),v=o(157),component=Object(d.a)(r,(function(){var t=this.$createElement,e=this._self._c||t;return e("v-list",{attrs:{"three-line":""}},[e("section",{staticClass:"container"},[e("div",[e("logo"),this._v(" "),e("video",{attrs:{id:"their-video",width:"200",autoplay:"",playsinline:""}}),this._v(" "),e("video",{attrs:{id:"my-video",muted:"true",width:"200",autoplay:"",playsinline:""},domProps:{muted:!0}}),this._v(" "),e("div",{staticClass:"main"},[e("h2",[this._v("Nuxt.js + SkyWayのラジオチャット")])])],1)]),this._v(" "),e("Chat")],1)}),[],!1,null,null,null);e.default=component.exports;h()(component,{Logo:o(207).default,Chat:o(347).default}),h()(component,{VList:v.a})}}]);
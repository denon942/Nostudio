(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{396:function(t,e,n){"use strict";n.r(e);n(50),n(62),n(88);var o,c=n(23),l=n(190),r=n(391),d=n.n(r),v={name:"ChatBoard",data:function(){return{comments:[],coment:"",APIKey:"79dca892-7921-4630-b281-eee96ef188e9",selectedAudio:"",audios:[],videos:[],localStream:null,peerId:"",calltoid:""}},methods:{send:function(){l.a.firestore().collection("room").doc("001").collection("comments").add({content:this.coment,createdAt:new Date,userid:"001"}).then(this.comments.push({content:this.coment}),this.coment="")},onChange:function(){""!=this.selectedAudio&&this.connectLocalCamera()},connectLocalCamera:(o=Object(c.a)(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={audio:!!this.selectedAudio&&{deviceId:{exact:this.selectedAudio}}},t.next=3,navigator.mediaDevices.getUserMedia(e);case 3:n=t.sent,document.getElementById("my-video").srcObject=n,this.localStream=n;case 6:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)}),makeCall:function(){console.log("makeCall");var t=this.peer.call(this.calltoid,this.localStream);this.connect(t)},connect:function(t){t.on("stream",(function(t){var e=document.getElementById("their-video");e.srcObject=t,e.play()}))},callOn:function(){this.localStream.getAudioTracks()[0].enabled=!0},callOff:function(){this.localStream.getAudioTracks()[0].enabled=!1}},watch:{dialog:function(){if(0==this.authenticatedUser){if(!0===this.dialog)return;this.$refs.form.reset()}}},mounted:function(){var t=this;this.peer=new d.a({key:this.APIKey,debug:3}),this.peer.on("open",(function(){t.peerId=t.peer.id})),this.peer.on("call",(function(e){e.answer(t.localStream),t.connect(e)})),navigator.mediaDevices.enumerateDevices().then((function(e){for(var i=0;i!==e.length;++i){var n=e[i];"audioinput"===n.kind&&t.audios.push({text:n.label||"Microphone ".concat(t.audios.length+1),value:n.deviceId})}}))},created:function(){var t=this;l.a.firestore().collection("room").doc("001").collection("comments").orderBy("createdAt","asc").get().then(function(){var e=Object(c.a)(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.forEach((function(e){console.log(e.data().content),t.comments.push({content:e.data().content})}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},m=n(39),h=n(67),f=n.n(h),_=n(245),y=n(368),C=n(390),w=n(187),k=n(188),x=n(115),A=n(189),I=n(191),V=n(81),O=n(380),L=n(386),component=Object(m.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-list",{attrs:{"three-line":""}},[n("section",{staticClass:"container"},[n("div",[n("logo"),t._v(" "),n("video",{attrs:{id:"their-video",width:"200",autoplay:"",playsinline:""}}),t._v(" "),n("video",{attrs:{id:"my-video",muted:"true",width:"200",autoplay:"",playsinline:""},domProps:{muted:!0}}),t._v(" "),n("div",{staticClass:"main"},[n("h2",[t._v("Nuxt.js + SkyWayのビデオチャット")]),t._v("\n                マイク:\n                "),n("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedAudio,expression:"selectedAudio"}],on:{change:[function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.selectedAudio=e.target.multiple?n:n[0]},t.onChange]}},[n("option",{attrs:{disabled:"",value:""}},[t._v("Please select one")]),t._v(" "),t._l(t.audios,(function(audio,e,o){return n("option",{key:o,domProps:{value:audio.value}},[t._v("\n                        "+t._s(audio.text)+"\n                    ")])}))],2),t._v(" "),n("div",[n("p",[t._v("Your id: "),n("span",{attrs:{id:"my-id"}},[t._v(t._s(t.peerId))])]),t._v(" "),n("p",[t._v("他のブラウザでこのIDをコールしましょう。")]),t._v(" "),n("h3",[t._v("コールする")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.calltoid,expression:"calltoid"}],attrs:{placeholder:"call id"},domProps:{value:t.calltoid},on:{input:function(e){e.target.composing||(t.calltoid=e.target.value)}}}),t._v(" "),n("button",{staticClass:"button--green",on:{click:t.makeCall}},[t._v("Call")]),t._v(" "),n("button",{staticClass:"button--green",on:{click:t.callOn}},[t._v("On")]),t._v(" "),n("button",{staticClass:"button--green",on:{click:t.callOff}},[t._v("Off")])])])],1)]),t._v(" "),t._l(t.comments,(function(e,o){return[n("v-list-item",{key:o,attrs:{index:o,avatar:""}},[n("v-list-item-avatar"),t._v(" "),n("v-list-item-content",[n("v-list-item-subtitle",{staticClass:"text--primary"},[t._v(t._s(e.content))]),t._v(" "),n("v-list-item-subtitle")],1),t._v(" "),n("v-list-item-action")],1)]})),t._v(" "),n("v-card",{staticClass:"grey display-1  pa-0 ma-0",attrs:{height:"50",elevation:"0",tile:""}},[n("v-row",{staticClass:"ma-0 pa-0",attrs:{justify:"end"}},[n("v-col",{staticClass:"ma-0 pa-0 py-4",attrs:{cols:"6"}},[n("v-text-field",{staticClass:"ma-0",attrs:{dense:"",label:"Message",color:"black"},model:{value:t.coment,callback:function(e){t.coment=e},expression:"coment"}})],1),t._v(" "),n("v-col",{staticClass:"ma-0 pa-0 py-1",attrs:{cols:"2"}},[n("v-btn",{staticClass:"pa-0 ma-0 ml-1",attrs:{tile:"",large:"",color:"teal",icon:""},on:{click:t.send}},[n("v-icon",{staticClass:"pa-0 ma-0",attrs:{color:"white"}},[t._v("mdi-send")])],1)],1)],1)],1)],2)}),[],!1,null,null,null);e.default=component.exports;f()(component,{Logo:n(247).default}),f()(component,{VBtn:_.a,VCard:y.a,VCol:C.a,VIcon:w.a,VList:k.a,VListItem:x.a,VListItemAction:A.a,VListItemAvatar:I.a,VListItemContent:V.a,VListItemSubtitle:V.b,VRow:O.a,VTextField:L.a})}}]);
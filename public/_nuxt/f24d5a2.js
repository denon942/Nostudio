(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{351:function(t,e,o){"use strict";o.r(e);o(83);var n,c=o(27),r=o(76),l=(o(348),{name:"ChatBoard",data:function(){return{comments:[],comments_box:[],coment:"",userId:""}},methods:{send:function(){r.a.firestore().collection("users").doc(this.user_id).collection("room").doc(this.user_id).collection("comments").add({content:this.coment,createdAt:new Date,userName:this.user_name}).then(this.coment="")},getChat:(n=Object(c.a)(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.firestore().collection("users").doc(this.user_id).collection("room").doc(this.user_id).collection("comments").orderBy("createdAt","asc").limit(50).get().then((function(t){t.forEach((function(t){e.comments_box.push({content:t.data().content,createdAt:t.data().createdAt.toDate().toLocaleTimeString().toLocaleString(),userName:t.data().userName})}))}));case 2:this.comments=this.comments_box,console.log(this.comments_box),this.comments_box=[];case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)}),onAuth:function(){this.$store.commit("onAuthStateChanged")}},computed:{user_name:function(){return this.$store.getters.user_name},user_id:function(){return this.$store.getters.user_id}},watch:{},mounted:function(){var t=this;""!=this.user_id&&r.a.firestore().collection("delivery").doc(this.user_id).onSnapshot((function(){r.a.firestore().collection("delivery").doc(t.user_id).get().then((function(e){t.deliveryId=e.data().peer,t.flg=e.data().flg,t.thumbnail=e.data().thumbnail,t.title=e.data().title,t.userId=e.data().user_id}))})),r.a.firestore().collection("users").doc(this.user_id).collection("room").doc(this.user_id).collection("comments").onSnapshot((function(){t.getChat()}))},created:function(){this.onAuth()}}),d=o(39),m=o(55),h=o.n(m),v=o(205),f=o(326),_=o(350),y=o(156),C=o(157),w=o(102),x=o(74),I=o(338),V=o(344),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-list",{attrs:{"three-line":"","min-width":"320"}},[o("v-list",{directives:[{name:"chat-scroll",rawName:"v-chat-scroll",value:{always:!1,smooth:!0,scrollonremoved:!0},expression:"{always: false, smooth: true, scrollonremoved:true}"}],staticClass:"overflow-y-auto",attrs:{"max-height":"470",height:"470",elevation:"0",tile:""}},t._l(t.comments,(function(e,n){return o("v-list-item",{key:n,staticClass:"black--text",attrs:{index:n}},[o("v-list-item-subtitle",{staticClass:"subtitle-1"},[o("span",{staticClass:"blue--text font-weight-bold"},[t._v(t._s(e.userName))]),t._v(" "),o("span",{staticClass:"font-weight-thin"},[t._v(t._s(e.createdAt)+":")]),t._v("\n                "+t._s(e.content)+"\n            ")])],1)})),1),t._v(" "),o("v-card",{staticClass:"grey display-1  pa-0 ma-0",attrs:{height:"50",elevation:"0",tile:""}},[o("v-row",{staticClass:"ma-0 pa-0",attrs:{justify:"center"}},[o("v-col",[o("v-text-field",{staticClass:"ma-0",attrs:{dense:"",label:"Message",color:"black"},model:{value:t.coment,callback:function(e){t.coment=e},expression:"coment"}})],1),t._v(" "),o("v-col",{staticClass:"ma-0 pa-0 py-1",attrs:{cols:"2"}},[o("v-btn",{staticClass:"pa-0 ma-0 ml-1",attrs:{tile:"",large:"",color:"teal",icon:""},on:{click:t.send}},[o("v-icon",{staticClass:"pa-0 ma-0",attrs:{color:"white"}},[t._v("mdi-send")])],1)],1)],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports;h()(component,{VBtn:v.a,VCard:f.a,VCol:_.a,VIcon:y.a,VList:C.a,VListItem:w.a,VListItemSubtitle:x.b,VRow:I.a,VTextField:V.a})},356:function(t,e,o){"use strict";o.r(e);var n,c=o(76),r=o(348),l=o.n(r),d=(o(83),o(27)),m={name:"ChatBoard",data:function(){return{comments:[],comments_box:[],coment:"",userId:""}},methods:{send:function(){c.a.firestore().collection("users").doc(this.items.user_id).collection("room").doc(this.items.user_id).collection("comments").add({content:this.coment,createdAt:new Date,userName:this.user_name}).then(this.coment="")},getChat:(n=Object(d.a)(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.a.firestore().collection("users").doc(this.items.user_id).collection("room").doc(this.items.user_id).collection("comments").orderBy("createdAt","asc").limit(50).get().then((function(t){t.forEach((function(t){e.comments_box.push({content:t.data().content,createdAt:t.data().createdAt.toDate().toLocaleTimeString().toLocaleString(),userName:t.data().userName})}))}));case 2:this.comments=this.comments_box,console.log(this.comments_box),this.comments_box=[];case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)}),onAuth:function(){this.$store.commit("onAuthStateChanged")}},computed:{user_name:function(){return this.$store.getters.user_name},items:function(){return this.$store.getters.delivery_info}},watch:{},mounted:function(){var t=this;console.log(this.items.user_id),""!=this.items.user_id&&c.a.firestore().collection("delivery").doc(this.items.user_id).onSnapshot((function(){c.a.firestore().collection("delivery").doc(t.items.user_id).get().then((function(e){t.deliveryId=e.data().peer,t.flg=e.data().flg,t.thumbnail=e.data().thumbnail,t.title=e.data().title,t.userId=e.data().user_id}))})),c.a.firestore().collection("users").doc(this.items.user_id).collection("room").doc(this.items.user_id).collection("comments").onSnapshot((function(){t.getChat()}))},created:function(){this.onAuth()}},h=o(39),v=o(55),f=o.n(v),_=o(205),y=o(326),C=o(350),w=o(156),x=o(157),I=o(102),V=o(74),A=o(338),k=o(344),component=Object(h.a)(m,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-list",{attrs:{"three-line":"","min-width":"320"}},[o("v-list",{directives:[{name:"chat-scroll",rawName:"v-chat-scroll",value:{always:!1,smooth:!0,scrollonremoved:!0},expression:"{always: false, smooth: true, scrollonremoved:true}"}],staticClass:"overflow-y-auto",attrs:{"max-height":"470",height:"470",elevation:"0",tile:""}},t._l(t.comments,(function(e,n){return o("v-list-item",{key:n,staticClass:"black--text",attrs:{index:n}},[o("v-list-item-subtitle",{staticClass:"subtitle-1"},[o("span",{staticClass:"blue--text font-weight-bold"},[t._v(t._s(e.userName))]),t._v(" "),o("span",{staticClass:"font-weight-thin"},[t._v(t._s(e.createdAt)+":")]),t._v("\n                "+t._s(e.content)+"\n            ")])],1)})),1),t._v(" "),o("v-card",{staticClass:"grey display-1  pa-0 ma-0",attrs:{height:"50",elevation:"0",tile:""}},[o("v-row",{staticClass:"ma-0 pa-0",attrs:{justify:"center"}},[o("v-col",[o("v-text-field",{staticClass:"ma-0",attrs:{dense:"",label:"Message",color:"black"},model:{value:t.coment,callback:function(e){t.coment=e},expression:"coment"}})],1),t._v(" "),o("v-col",{staticClass:"ma-0 pa-0 py-1",attrs:{cols:"2"}},[o("v-btn",{staticClass:"pa-0 ma-0 ml-1",attrs:{tile:"",large:"",color:"teal",icon:""},on:{click:t.send}},[o("v-icon",{staticClass:"pa-0 ma-0",attrs:{color:"white"}},[t._v("mdi-send")])],1)],1)],1)],1)],1)}),[],!1,null,null,null),S=component.exports;f()(component,{VBtn:_.a,VCard:y.a,VCol:C.a,VIcon:w.a,VList:x.a,VListItem:I.a,VListItemSubtitle:V.b,VRow:A.a,VTextField:k.a});var j={name:"ChatBoard",data:function(){return{APIKey:"79dca892-7921-4630-b281-eee96ef188e9",selectedAudio:"",audios:[],videos:[],localStream:null,peerId:"",calltoid:"",deliveryId:"",flg:!1,thumbnail:"",title:""}},methods:{makeCall:function(){var t=this.peer.call(this.calltoid,this.localStream);this.connect(t)},connect:function(t){t.on("stream",(function(t){var e=document.getElementById("their-video");e.srcObject=t,e.play()}))}},watch:{deliveryId:function(){this.calltoid=this.deliveryId,""!=this.deliveryId&&this.makeCall()}},mounted:function(){var t=this;this.peer=new l.a({key:this.APIKey,debug:3}),this.peer.on("open",(function(){t.peerId=t.peer.id})),this.peer.on("call",(function(e){e.answer(t.localStream),t.connect(e)})),""!=this.items.user_id&&c.a.firestore().collection("delivery").doc(this.items.user_id).onSnapshot((function(){c.a.firestore().collection("delivery").doc(t.items.user_id).get().then((function(e){t.deliveryId=e.data().peer,t.flg=e.data().flg,t.thumbnail=e.data().thumbnail,t.title=e.data().title}))}))},computed:{items:function(){return this.$store.getters.delivery_info}},components:{Chat:S},created:function(){}},L=o(340),N=o(136),$=Object(h.a)(j,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-container",[o("v-row",{attrs:{justify:"center"}},[o("v-col",{attrs:{cols:"12",lg:"8",md:"8",sm:"12",xs:"12"}},[o("v-card",{staticClass:"pa-2"},[o("v-row",{attrs:{justify:"center"}},[o("v-col",{attrs:{cols:"auto"}},[o("v-img",{attrs:{"max-height":"400","max-width":"600",src:t.thumbnail}}),t._v(" "),o("audio",{attrs:{id:"their-video",width:"200",autoplay:"",playsinline:""}}),t._v(" "),o("audio",{attrs:{id:"my-video",muted:"true",width:"200",autoplay:"",playsinline:""}})],1)],1)],1),t._v(" "),o("h2",[t._v("タイトル名："+t._s(t.title)+" ")]),t._v(" "),t.flg?t._e():o("h3",[t._v("配信は終了いたしました")])],1),t._v(" "),o("v-col",{attrs:{cols:"12",lg:"4",md:"4",sm:"12",xs:"12"}},[o("Chat")],1)],1)],1)}),[],!1,null,null,null);e.default=$.exports;f()($,{Chat:o(351).default}),f()($,{VCard:y.a,VCol:C.a,VContainer:L.a,VImg:N.a,VRow:A.a})}}]);